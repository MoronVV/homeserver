- name: Install UFW
  package:
    name:
      - ufw
    state: latest
  register: ufw_installed

- name: Reboot after UFW install
  reboot:
  when: ufw_installed.changed

- name: Allow ssh in UFW
  community.general.ufw:
    rule: allow
    name: OpenSSH

- name: Allow nginx in UFW
  community.general.ufw:
    rule: allow
    name: Nginx Full

- name: Allow raspotify control port
  community.general.ufw:
    rule: allow
    port: "4070"

- name: Allow librespot zeroconf port
  community.general.ufw:
    rule: allow
    port: "4071"

- name: Enable UFW
  community.general.ufw:
    state: enabled
